<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanzy | Forgot Password</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            /* Aesthetic background: Subtle radial gradient for depth */
            background: radial-gradient(circle at top left, #e0f2fe, #f0f2f5); 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .input-field {
            @apply w-full p-3 border border-gray-200 rounded-xl shadow-inner focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition duration-200;
        }
        .btn-primary {
            @apply w-full bg-emerald-600 text-white font-semibold py-3 rounded-xl shadow-lg shadow-emerald-300 transition duration-300 transform hover:bg-emerald-700 hover:scale-[1.01];
        }
        .btn-back {
             @apply w-full bg-gray-200 text-gray-800 font-semibold py-3 rounded-xl hover:bg-gray-300 transition duration-200 mt-4;
        }
        .step-content {
            min-height: 200px; /* Ensure consistent card height */
        }
    </style>
</head>
<body>

    <div class="w-full max-w-sm">
        
        <!-- Logo/Title -->
        <div class="text-center mb-10">
            <h1 class="text-5xl font-extrabold text-blue-600 tracking-tight">
                Cleanzy
            </h1>
            <p class="text-gray-500 mt-2 font-medium">Password Reset Request</p>
        </div>

        <!-- Reset Card -->
        <div class="bg-white shadow-2xl rounded-2xl p-8 border border-gray-100">
            
            <h2 class="text-2xl font-bold text-gray-800 mb-2" id="card-title">Trouble Logging In?</h2>
            <p class="text-gray-600 mb-6 text-sm" id="card-subtitle">
                Enter your registered **Email** or **Mobile Number** to receive a link or OTP to reset your password.
            </p>

            <div id="step-1" class="step-content">
                <form onsubmit="handleRequestOtp(event)">
                    <div class="space-y-5">
                        
                        <div>
                            <label for="recovery-id" class="block text-sm font-medium text-gray-700 mb-2">Email or Mobile</label>
                            <input type="text" id="recovery-id" class="input-field" placeholder="e.g., yourname@example.com or 9876543210" required>
                        </div>
                        
                        <button type="submit" class="btn-primary">
                            Send Reset Link / OTP
                        </button>
                        
                        <button type="button" onclick="goBackToLogin()" class="btn-back">
                            ← Back to Login
                        </button>

                    </div>
                </form>
            </div>

            <div id="step-2" class="step-content hidden">
                 <form onsubmit="handleVerifyOtp(event)">
                    <div class="space-y-5">
                        
                        <div>
                            <label for="otp" class="block text-sm font-medium text-gray-700 mb-2">Enter OTP</label>
                            <input type="text" id="otp" class="input-field text-center tracking-widest text-lg font-bold" placeholder="• • • • • •" required maxlength="6">
                        </div>
                        
                        <button type="submit" class="btn-primary">
    <!--hard coded to verify 123456 no other value will be accepted unless logic-->                        Verify OTP
                        </button>
                        
                        <p class="text-center text-xs text-gray-500 mt-3">OTP sent to <span id="display-recovery-id" class="font-semibold text-gray-700"></span>. <a href="#" onclick="handleRequestOtp(event, true)" class="text-blue-600 hover:underline">Resend OTP</a></p>

                    </div>
                </form>
            </div>

            <div id="step-3" class="step-content hidden">
                <form onsubmit="handleSetNewPassword(event)">
                    <div class="space-y-5">
                        
                        <div>
                            <label for="new-password" class="block text-sm font-medium text-gray-700 mb-2">New Password</label>
                            <input type="password" id="new-password" class="input-field" placeholder="Enter new password" required>
                        </div>
                         <div>
                            <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password</label>
                            <input type="password" id="confirm-password" class="input-field" placeholder="Confirm new password" required>
                        </div>
                        
                        <button type="submit" class="btn-primary">
     <!-- set new pass redirect to login --><a href="file:///C:/Users/Om%20Shirurkar/Desktop/cleanzy/login.html">Set New Password</a>

                        </button>
                    </div>
                </form>
            </div>


        </div>
        
        <!-- Footer Info -->
        <p class="text-center text-xs text-gray-500 mt-8">
            © 2025 Cleanzy Management. Security First.
        </p>

    </div>

    <script>
        let currentRecoveryId = '';

        function showStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            // Show the target step
            document.getElementById(`step-${stepNumber}`).classList.remove('hidden');

            // Update header text based on step
            const title = document.getElementById('card-title');
            const subtitle = document.getElementById('card-subtitle');

            switch (stepNumber) {
                case 1:
                    title.textContent = 'Trouble Logging In?';
                    subtitle.textContent = 'Enter your registered **Email** or **Mobile Number** to receive a link or OTP to reset your password.';
                    break;
                case 2:
                    title.textContent = 'Verify OTP';
                    subtitle.textContent = 'A 6-digit verification code has been sent to your contact information.';
                    break;
                case 3:
                    title.textContent = 'Set New Password';
                    subtitle.textContent = 'Your verification was successful. Choose a strong new password.';
                    break;
            }
        }

        // --- Step 1: Request OTP ---
        function handleRequestOtp(event, isResend = false) {
            event.preventDefault(); 
            const recoveryId = document.getElementById('recovery-id').value;

            if (recoveryId) {
                currentRecoveryId = recoveryId;
                
                // In a real app, backend API call to generate and send OTP happens here.
                
                if (!isResend) {
                     alert(`OTP requested for ${recoveryId}. Check your inbox/phone. (Simulated OTP: 123456)`);
                } else {
                     alert(`New OTP successfully resent to ${recoveryId}. (Simulated OTP: 123456)`);
                }
               
                // Update display and move to Step 2
                document.getElementById('display-recovery-id').textContent = recoveryId;
                showStep(2); 

            } else {
                alert('Please enter a registered Email or Mobile Number.');
            }
        }

        // --- Step 2: Verify OTP (FIXED) ---
        function handleVerifyOtp(event) {
            event.preventDefault();
            const otp = document.getElementById('otp').value;

            if (otp === '123456') { // Simple simulation: hardcoded OTP
                alert('OTP Verified! Proceeding to password reset.');
                showStep(3); // **CRITICAL FIX: Explicitly call showStep(3)**
            } else {
                alert('Invalid OTP. Please try again or resend the code.');
            }
        }

        // --- Step 3: Set New Password ---
        function handleSetNewPassword(event) {
            event.preventDefault();
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (newPassword.length < 6) {
                alert('Password must be at least 6 characters long.');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('New Password and Confirm Password do not match.');
                return;
            }
            
            // In a real app, backend API call to update password using the recoveryId happens here.
            
            alert('Password successfully reset! Redirecting to login.');
            
            setTimeout(() => {
                // Redirect back to the login page after final reset
                goBackToLogin();
            }, 1500); 
        }
        
        // --- Navigation Function ---
        function goBackToLogin() {
            // Using the path from the original button
             window.location.href='file:///C:/Users/Om%20Shirurkar/Desktop/cleanzy/login_page.html';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            showStep(1);
        });
    </script>
</body>
</html>